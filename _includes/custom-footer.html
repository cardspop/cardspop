<script>
  (function () {
    var key = 'theme-preference';
    var root = document.documentElement;
    function applyTheme(t) {
      root.removeAttribute('data-theme');
      if (t === 'dark') root.setAttribute('data-theme', 'dark');
      if (t === 'light') root.setAttribute('data-theme', 'light');
    }
    try {
      var saved = localStorage.getItem(key);
      if (saved) applyTheme(saved);
      document.addEventListener('click', function (e) {
        if (e.target && e.target.id === 'theme-toggle') {
          var current = localStorage.getItem(key) || 'system';
          var next = current === 'system' ? 'dark' : current === 'dark' ? 'light' : 'system';
          localStorage.setItem(key, next);
          applyTheme(next);
        }
      });
    } catch (e) {}
  })();
</script>

